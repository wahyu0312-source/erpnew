<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <title>東京精密発條株式会社システム</title>
  <link rel="icon" href="assets/tsh.png">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <!-- Styles -->
  <link rel="stylesheet" href="style.css">

  <!-- Charts & QR -->
  <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script defer src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>

  <!-- App -->
  <script defer src="app.js"></script>
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <img src="assets/tsh.png" alt="logo" class="logo">
      <h1>生産ダッシュボード</h1>
    </div>
    <nav class="nav">
      <button data-nav="dashboard" class="active"><i class="fa-solid fa-gauge"></i> ダッシュボード</button>
      <button data-nav="genpin"><i class="fa-solid fa-list-check"></i> 生産現品票</button>
      <button data-nav="yotei"><i class="fa-solid fa-truck-ramp-box"></i> 出荷予定</button>
      <button data-nav="sales" class="ghost"><i class="fa-solid fa-briefcase"></i> 営業</button>
      <button data-nav="scan"><i class="fa-solid fa-qrcode"></i> スキャン/手動入力</button>
      <button data-nav="charts"><i class="fa-solid fa-chart-column"></i> 不良品チャート</button>
      <button id="logout"><i class="fa-solid fa-right-from-bracket"></i> ログアウト</button>
    </nav>
  </header>

  <main class="container">
    <!-- DASHBOARD -->
    <section id="view-dashboard" class="view show">
      <div class="cards">
        <div class="card">
          <h3>当日スナップショット</h3>
          <div id="snapshot" class="grid-4">
            <div><div class="kpi" id="kpi-orders">0</div><div class="muted">現品票（件）</div></div>
            <div><div class="kpi" id="kpi-done">0</div><div class="muted">完了（件）</div></div>
            <div><div class="kpi" id="kpi-ok">0</div><div class="muted">OK品（個）</div></div>
            <div><div class="kpi" id="kpi-ng">0</div><div class="muted">不良品（個）</div></div>
          </div>
        </div>
        <div class="card">
          <h3>工程別 不良品</h3>
          <canvas id="defectByProcess"></canvas>
        </div>
      </div>
    </section>

    <!-- 生産現品票 -->
    <section id="view-genpin" class="view">
      <div class="card">
        <div class="card-head">
          <h3>生産現品票（CSV/Excel 取込 & 手入力）</h3>
          <div class="actions">
            <input type="file" id="imp-genpin" accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel">
            <button id="btn-genpin-upload"><i class="fa-solid fa-upload"></i> 取込</button>
          </div>
        </div>
        <div class="form grid-4">
          <label>生産開始<input id="gp-start" type="date"></label>
          <label>得意先<input id="gp-cust" type="text" placeholder="例）A社"></label>
          <label>図番<input id="gp-zu" type="text"></label>
          <label>機種<input id="gp-kishu" type="text"></label>
          <label>商品名<input id="gp-shohin" type="text"></label>
          <label>数量<input id="gp-qty" type="number" min="0" step="1"></label>
          <label>注番<input id="gp-chuban" type="text"></label>
          <label>備考<input id="gp-biko" type="text"></label>
          <button id="btn-genpin-add" class="primary col-span-2"><i class="fa-solid fa-plus"></i> 登録</button>
        </div>
        <div class="table-wrap">
          <table id="tbl-genpin">
            <thead><tr>
              <th>生産開始</th><th>得意先</th><th>図番</th><th>機種</th><th>商品名</th><th>数量</th><th>注番</th><th>備考</th>
            </tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- 出荷予定 -->
    <section id="view-yotei" class="view">
      <div class="card">
        <div class="card-head">
          <h3>出荷予定（CSV/Excel 取込 & 手入力）</h3>
          <div class="actions">
            <input type="file" id="imp-yotei" accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel">
            <button id="btn-yotei-upload"><i class="fa-solid fa-upload"></i> 取込</button>
          </div>
        </div>
        <div class="form grid-4">
          <label>出荷日<input id="yt-date" type="date"></label>
          <label>得意先<input id="yt-cust" type="text"></label>
          <label>図番<input id="yt-zu" type="text"></label>
          <label>機種<input id="yt-kishu" type="text"></label>
          <label>商品名<input id="yt-shohin" type="text"></label>
          <label>数量<input id="yt-qty" type="number" min="0" step="1"></label>
          <label>送り先<input id="yt-okuri" type="text"></label>
          <label>注番<input id="yt-chuban" type="text"></label>
          <label class="col-span-2">備考<input id="yt-biko" type="text"></label>
          <button id="btn-yotei-add" class="primary col-span-2"><i class="fa-solid fa-plus"></i> 登録</button>
        </div>
        <div class="table-wrap">
          <table id="tbl-yotei">
            <thead><tr>
              <th>出荷日</th><th>得意先</th><th>図番</th><th>機種</th><th>商品名</th><th>数量</th><th>送り先</th><th>注番</th><th>備考</th>
            </tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- 営業（入力だけ・保守用） -->
    <section id="view-sales" class="view">
      <div class="card">
        <h3>営業（入力のみ）</h3>
        <div class="form grid-4">
          <label>注番<input id="sl-chuban" type="text"></label>
          <label>機種<input id="sl-kishu" type="text"></label>
          <label>商品名<input id="sl-shohin" type="text"></label>
          <label>図番<input id="sl-zu" type="text"></label>
          <label>数量<input id="sl-qty" type="number" min="0" step="1"></label>
          <label>得意先<input id="sl-cust" type="text"></label>
          <label>受注日<input id="sl-rec" type="date"></label>
          <label>希望納期<input id="sl-due" type="date"></label>
          <label class="col-span-2">備考<input id="sl-biko" type="text"></label>
          <button id="btn-sales-add" class="primary col-span-2"><i class="fa-solid fa-plus"></i> 登録</button>
        </div>
      </div>
    </section>

    <!-- スキャン/手動入力 -->
    <section id="view-scan" class="view">
      <div class="card">
        <h3>工程変更（スキャン/手動）</h3>
        <div class="grid-4">
          <label>注番<input id="sc-chuban" type="text" placeholder="QR または 手入力"></label>
          <label>工程
            <select id="sc-process">
              <option>切断</option>
              <option>曲げ</option>
              <option>レザー加工</option>
              <option>組立</option>
              <option>検査中</option>
              <option>検査済</option>
              <option>出荷</option>
            </select>
          </label>
          <label>OK品（個）<input id="sc-ok" type="number" min="0" step="1" value="0"></label>
          <label>不良品（個）<input id="sc-ng" type="number" min="0" step="1" value="0"></label>
          <label class="col-span-2">ステータス（任意）<input id="sc-status" type="text" placeholder="例）優先/保留 など"></label>
          <button id="btn-set-process" class="primary col-span-2"><i class="fa-solid fa-check"></i> 反映</button>
        </div>
      </div>
    </section>

    <!-- 不良品チャート -->
    <section id="view-charts" class="view">
      <div class="card">
        <h3>工程別 不良品（集計）</h3>
        <canvas id="chart-defect"></canvas>
      </div>
    </section>
  </main>

  <footer class="footer">
    <small>© 東京精密発條株式会社 — 内部利用のみ</small>
  </footer>

  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js');
    }
  </script>
</body>
</html>
